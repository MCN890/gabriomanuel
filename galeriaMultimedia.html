<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLG</title>
    <style>
        /* ---------- RESET GLOBAL ---------- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fafafa;
            color: #222;
            line-height: 1.7;
        }

        /* ---------- CABEÇALHO (Versão Aprimorada 1000%) ---------- */
        header {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #ff6f61, #ffb400, #ff9a00, #ff6f61);
            background-size: 400% 400%;
            animation: gradientFlow 10s ease-in-out infinite;
            color: #fff;
            text-align: center;
            padding: 4rem 1.5rem 5rem;
            border-bottom-left-radius: 35% 12%;
            border-bottom-right-radius: 35% 12%;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
            transform-style: preserve-3d;
        }

        /* --- Efeito de brilho animado sobre o gradiente --- */
        header::before {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.4), transparent 60%),
                radial-gradient(circle at bottom right, rgba(255, 255, 255, 0.3), transparent 70%);
            mix-blend-mode: overlay;
            opacity: 0.6;
            animation: shimmer 8s ease-in-out infinite alternate;
        }

        /* --- Título principal --- */
        header h1 {
            position: relative;
            font-size: 3.2rem;
            letter-spacing: 2.5px;
            text-transform: uppercase;
            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.25);
            animation: fadeInDown 1.2s ease forwards;
            z-index: 1;
            background: linear-gradient(90deg, #fff, #ffeab6, #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* --- Subtítulo --- */
        header p {
            font-size: 1.15rem;
            margin-top: 1rem;
            opacity: 0.92;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 400;
            letter-spacing: 0.5px;
            animation: fadeInUp 1.4s ease forwards;
            z-index: 1;
        }

        /* --- Animações --- */
        @keyframes gradientFlow {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes shimmer {
            0% {
                opacity: 0.3;
                transform: scale(1) rotate(0deg);
            }

            100% {
                opacity: 0.6;
                transform: scale(1.05) rotate(2deg);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- Responsividade --- */
        @media (max-width: 768px) {
            header {
                padding: 3rem 1rem 4rem;
                border-bottom-left-radius: 45% 15%;
                border-bottom-right-radius: 45% 15%;
            }

            header h1 {
                font-size: 2.4rem;
                letter-spacing: 1.5px;
            }

            header p {
                font-size: 1rem;
            }
        }


        /* ---------- SECÇÕES (VERSÃO REFINADA E ANIMADA) ---------- */
        section {
            position: relative;
            padding: 3rem 2.5rem;
            margin: 2.5rem auto;
            max-width: 1150px;
            border-radius: 18px;
            background: linear-gradient(145deg, #ffffff, #f8f8f8);
            box-shadow:
                0 10px 25px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            overflow: hidden;
            opacity: 0;
            transform: translateY(60px) scale(0.98);
            animation: fadeInSection 1s cubic-bezier(0.19, 1, 0.22, 1) forwards;
            backdrop-filter: blur(5px);
            transition: transform 0.6s ease, box-shadow 0.6s ease;
        }

        /* Iluminação de destaque quando o usuário passa o mouse */
        section:hover {
            transform: translateY(-6px) scale(1.01);
            box-shadow:
                0 20px 40px rgba(0, 0, 0, 0.15),
                inset 0 0 10px rgba(255, 111, 97, 0.2);
        }

        /* ---------- BORDA LUMINOSA ANIMADA (Versão Aprimorada 1000%) ---------- */
        section {
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        /* --- Efeito de borda luminosa envolvente --- */
        section::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 18px;
            padding: 2px;
            background: linear-gradient(135deg,
                    rgba(255, 111, 97, 0.85),
                    rgba(255, 180, 0, 0.85),
                    rgba(255, 154, 0, 0.85),
                    rgba(255, 111, 97, 0.85));
            background-size: 400% 400%;
            animation: borderPulse 10s ease-in-out infinite;

            /* Máscara compatível com WebKit e padrão */
            -webkit-mask:
                linear-gradient(#fff 0 0) content-box,
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: source-out;
            mask-composite: exclude;
            pointer-events: none;

            /* Suave reflexo interno */
            box-shadow: inset 0 0 12px rgba(255, 255, 255, 0.15);
            opacity: 0.95;
            z-index: 2;
        }

        /* --- Brilho dinâmico interno (simula energia passando nas bordas) --- */
        section::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 18px;
            background: radial-gradient(circle at 20% 30%,
                    rgba(255, 255, 255, 0.25),
                    transparent 70%);
            mix-blend-mode: overlay;
            animation: innerLight 6s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: 1;
        }

        /* --- Animações --- */
        @keyframes borderPulse {
            0% {
                background-position: 0% 50%;
                filter: brightness(1) saturate(1);
            }

            50% {
                background-position: 100% 50%;
                filter: brightness(1.25) saturate(1.3);
            }

            100% {
                background-position: 0% 50%;
                filter: brightness(1) saturate(1);
            }
        }

        @keyframes innerLight {
            0% {
                opacity: 0.2;
                transform: scale(1);
            }

            100% {
                opacity: 0.45;
                transform: scale(1.03);
            }
        }

        /* --- Responsividade e performance --- */
        @media (max-width: 768px) {
            section::before {
                border-radius: 14px;
                padding: 1.5px;
            }

            section::after {
                border-radius: 14px;
            }
        }

        /* Delays progressivos para entrada cinematográfica */
        section:nth-of-type(2) {
            animation-delay: 0.2s;
        }

        section:nth-of-type(3) {
            animation-delay: 0.4s;
        }

        section:nth-of-type(4) {
            animation-delay: 0.6s;
        }

        /* Títulos com destaque visual e tipografia sofisticada */
        section h2 {
            position: relative;
            display: inline-block;
            padding-left: 1.2rem;
            margin-bottom: 1.8rem;
            color: #ff6f61;
            font-size: 2.2rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: color 0.4s ease;
        }

        /* Barra lateral animada no título */
        section h2::before {
            content: "";
            position: absolute;
            left: 0;
            top: 5px;
            bottom: 5px;
            width: 6px;
            border-radius: 4px;
            background: linear-gradient(180deg, #ff6f61, #ffb400);
            animation: gradientFlow 5s linear infinite;
        }

        /* Efeito hover no título */
        section h2:hover {
            color: #ffb400;
        }

        /* ---------- ANIMAÇÕES ---------- */
        @keyframes fadeInSection {
            0% {
                opacity: 0;
                transform: translateY(60px) scale(0.98);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes borderGlow {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes gradientFlow {
            0% {
                background-position: 0% 0%;
            }

            100% {
                background-position: 0% 100%;
            }
        }

        /* ---------- RESPONSIVIDADE ---------- */
        @media (max-width: 768px) {
            section {
                padding: 2rem 1.5rem;
                border-radius: 14px;
            }

            section h2 {
                font-size: 1.8rem;
                margin-bottom: 1.2rem;
            }
        }


        /* ---------- PERFIL (Versão Aprimorada 1000%) ---------- */
        .perfil {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
            padding: 2.5rem;
            background: linear-gradient(145deg, #ffffff, #f9f9f9);
            border-radius: 18px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
            transition: box-shadow 0.4s ease, transform 0.4s ease;
            transform: translateY(30px);
            animation: fadeInUp 1s ease forwards;
        }

        .perfil:hover {
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.12);
            transform: translateY(0);
        }

        /* ---------- PERFIL CINEMATOGRÁFICO APRIMORADO ---------- */
        .perfil {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 2rem;
            position: relative;
            animation: fadeInUp 1s ease forwards;
        }

        /* --- Imagem do Perfil --- */
        .perfil img {
            width: 170px;
            height: 170px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(255, 180, 0, 0.8);
            background: linear-gradient(145deg, #fffdf0, #fff9e6);
            box-shadow:
                0 8px 25px rgba(255, 180, 0, 0.35),
                0 0 0 6px rgba(255, 255, 255, 0.4) inset;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            filter: saturate(1.05) brightness(1);
            position: relative;
            z-index: 1;
        }

        /* Reflexo e luz dinâmica na imagem */
        .perfil img::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3), transparent 70%);
            mix-blend-mode: screen;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .perfil img:hover {
            transform: rotate(-6deg) scale(1.1);
            filter: saturate(1.3) brightness(1.1);
            box-shadow:
                0 15px 45px rgba(255, 180, 0, 0.55),
                0 0 0 8px rgba(255, 255, 255, 0.5) inset;
        }

        .perfil img:hover::after {
            opacity: 1;
        }

        /* --- Conteúdo textual --- */
        .perfil div {
            flex: 1;
            min-width: 260px;
            text-align: left;
            animation: fadeInUp 1.2s ease forwards;
        }

        .perfil div h3 {
            font-size: 2rem;
            color: #222;
            font-weight: 800;
            letter-spacing: 0.7px;
            position: relative;
            margin-bottom: 0.8rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15);
        }

        /* Sub-linha animada com brilho */
        .perfil div h3::after {
            content: "";
            position: absolute;
            bottom: -6px;
            left: 0;
            width: 70px;
            height: 3.5px;
            background: linear-gradient(90deg, #ffb400, #ff6f61, #ff9a00);
            border-radius: 3px;
            animation: lineGlow 3s ease-in-out infinite;
        }

        @keyframes lineGlow {

            0%,
            100% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.6);
            }
        }

        .perfil div p {
            color: #555;
            font-size: 1.1rem;
            line-height: 1.8;
            max-width: 620px;
            transition: color 0.3s ease, transform 0.3s ease;
            text-shadow: 0 0 1px rgba(0, 0, 0, 0.05);
        }

        .perfil div p:hover {
            color: #2a2a2a;
            transform: translateX(2px);
        }

        /* --- Animação de entrada --- */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- Responsividade --- */
        @media (max-width: 768px) {
            .perfil {
                flex-direction: column;
                text-align: center;
                padding: 2rem 1.5rem;
            }

            .perfil img {
                width: 150px;
                height: 150px;
                transform: none;
            }

            .perfil div h3::after {
                left: 50%;
                transform: translateX(-50%);
            }

            .perfil div p {
                max-width: 90%;
                margin: 0 auto;
            }
        }





        /* ---------- RODAPÉ ---------- */
        footer {
            text-align: center;
            padding: 1.8rem 1rem;
            background: #222;
            color: #fff;
            font-size: 0.95rem;
            margin-top: 3rem;
            letter-spacing: 0.5px;
            border-top: 3px solid #ff6f61;
        }

        footer span {
            color: #ffb400;
        }

        /* ---------- ANIMAÇÕES ---------- */
        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-25px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ---------- RESPONSIVIDADE ---------- */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2.3rem;
            }

            section {
                padding: 1.5rem;
            }

            .perfil img {
                width: 120px;
                height: 120px;
            }

            .perfil div h3 {
                font-size: 1.4rem;
            }

            .perfil div p {
                font-size: 0.95rem;
            }
        }

        @media (max-width: 480px) {
            header {
                padding: 2rem 1rem;
            }

            section h2 {
                font-size: 1.6rem;
            }
        }
    </style>
</head>

<body>

    <header>
        <h1>Galeria Multimédia</h1>
        <p>Um reflexo visual e sonoro da criatividade</p>
    </header>

    <!-- PERFIL -->
    <section>
        <h2>Perfil</h2>
        <div class="perfil">
            <img src="perfil.jpg" alt="Foto de Perfil">
            <div>
                <h3>Gabrio Manuel Bento</h3>
                <p>Em um futuro próximo... Vais falar do meu nome com imensa nostalgia.</p>
            </div>
        </div>
    </section>

    <!-- ====== SEÇÃO FOTOS MODERNIZADA & APRIMORADA ====== -->
    <section aria-labelledby="fotos-title" class="gallery-section">
        <h2 id="fotos-title">Fotos</h2>

        <div class="fotos photo-grid" role="list">
            <!-- Exemplo de item: substitua src / data-fullsrc / alt / caption conforme necessário -->
            <figure class="photo-card" role="listitem" data-index="0">
                <img src="1.jpg" data-fullsrc="1.jpg" alt="Descrição da foto 1" loading="lazy" tabindex="0"
                    data-caption="Um presente de aniversário de última hora🤣
" onload="this.classList.add('loaded')">
                <figcaption class="caption">
                    <div class="caption-left">
                        <div class="caption-text">2025</div>
                        <div class="caption-sub">Owl birthday</div>
                    </div>
                    <div class="caption-right">
                        <button class="view-btn" aria-label="Abrir Foto 1">Ampliar</button>
                    </div>
                </figcaption>
            </figure>

            <figure class="photo-card" role="listitem" data-index="1">
                <img src="2.jpg" data-fullsrc="2.jpg" alt="Descrição da foto 2" loading="lazy" tabindex="0"
                    data-caption="Uma crítica ao estado mais natural do ser humano, maldade"
                    onload="this.classList.add('loaded')">
                <figcaption class="caption">
                    <div class="caption-left">
                        <div class="caption-text">2024</div>
                        <div class="caption-sub">What have you done?</div>
                    </div>
                    <div class="caption-right">
                        <button class="view-btn" aria-label="Abrir Foto 2">Ampliar</button>
                    </div>
                </figcaption>
            </figure>

            <figure class="photo-card" role="listitem" data-index="2">
                <img src="3.jpg" data-fullsrc="3.jpg" alt="Descrição da foto 3" loading="lazy" tabindex="0"
                    data-caption="Foi em um estágio de auto reflexão sobre a minha capacidade de expressar ou mostrar afecto de uma forma orgânica sem ser forçado"
                    onload="this.classList.add('loaded')">
                <figcaption class="caption">
                    <div class="caption-left">
                        <div class="caption-text">2020</div>
                        <div class="caption-sub">Pinoqhio heart</div>
                    </div>
                    <div class="caption-right">
                        <button class="view-btn" aria-label="Abrir Foto 3">Ampliar</button>
                    </div>
                </figcaption>
            </figure>

            <figure class="photo-card" role="listitem" data-index="3">
                <img src="4.jpg" data-fullsrc="4.jpg" alt="Descrição da foto 4" loading="lazy" tabindex="0"
                    data-caption="O dia que percebi que até os sorrisos mais calorosos carregam as feridas mais profundas."
                    onload="this.classList.add('loaded')">
                <figcaption class="caption">
                    <div class="caption-left">
                        <div class="caption-text">2024</div>
                        <div class="caption-sub">Gloomy gaze</div>
                    </div>
                    <div class="caption-right">
                        <button class="view-btn" aria-label="Abrir Foto 4">Ampliar</button>
                    </div>
                </figcaption>
            </figure>
        </div>
    </section>

    <!-- ====== LIGHTBOX MODERNO (SUBSTITUI O ANTERIOR) ====== -->
    <style>
        /* Variáveis para fácil personalização */
        :root {
            --radius: 14px;
            --accent1: #ffb400;
            --accent2: #ff6f61;
            --bg-overlay: rgba(12, 12, 12, 0.88);
        }

        /* Grid / cards */
        .photo-grid {
            display: grid;
            gap: 1.2rem;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            align-items: start;
        }

        .photo-card {
            position: relative;
            overflow: hidden;
            border-radius: var(--radius);
            background: linear-gradient(180deg, #fff, #fbfbfb);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07);
            transform: translateZ(0);
        }

        .photo-card img {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
            aspect-ratio: 4/3;
            transition: transform 420ms cubic-bezier(.2, .9, .3, 1), filter 320ms ease, opacity 320ms ease;
            cursor: zoom-in;
            will-change: transform, opacity;
            background: linear-gradient(90deg, #eee, #f6f6f6);
        }

        .photo-card img.loaded {
            animation: fadeInScale 720ms ease both;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(.98);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .photo-card:hover img,
        .photo-card:focus-within img {
            transform: translateY(-6px) scale(1.03);
            filter: brightness(1.03) saturate(1.05);
        }

        /* Caption overlay */
        .caption {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            padding: .8rem 1rem;
            display: flex;
            justify-content: space-between;
            gap: .6rem;
            align-items: center;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.5) 70%);
            transform: translateY(100%);
            opacity: 0;
            transition: transform 300ms ease, opacity 300ms ease;
            pointer-events: none;
        }

        .photo-card:hover .caption,
        .photo-card:focus-within .caption {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }

        .caption-left {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .caption-text {
            color: #fff;
            font-weight: 700;
            font-size: 0.98rem;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);
        }

        .caption-sub {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.82rem;
            opacity: .95;
        }

        .view-btn {
            background: linear-gradient(90deg, var(--accent1), var(--accent2));
            color: #111;
            border: 0;
            padding: .45rem .65rem;
            border-radius: 9px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 18px rgba(255, 140, 30, 0.12);
        }

        .view-btn:focus {
            outline: 3px solid rgba(255, 180, 0, 0.18);
        }

        /* Lightbox */
        .glightbox {
            position: fixed;
            inset: 0;
            display: none;
            align-items: center;
            justify-content: center;
            background: var(--bg-overlay);
            z-index: 99999;
            padding: 2rem;
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
        }

        .glightbox.open {
            display: flex;
        }

        .glightbox .inner {
            width: min(1100px, 96%);
            max-height: 92vh;
            display: grid;
            grid-template-rows: auto auto;
            gap: .6rem;
            align-items: center;
            justify-items: center;
        }

        .glightbox img {
            max-width: 100%;
            max-height: calc(92vh - 80px);
            border-radius: 12px;
            box-shadow: 0 28px 80px rgba(0, 0, 0, 0.6);
            transform-origin: center center;
            transition: transform 300ms ease;
        }

        .lb-controls {
            display: flex;
            gap: .6rem;
            align-items: center;
            justify-content: center;
        }

        .lb-btn {
            background: rgba(255, 255, 255, 0.06);
            color: #fff;
            border: 0;
            padding: .45rem .65rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(2px);
        }

        .lb-btn.icon {
            font-size: 1.2rem;
            padding: .5rem .7rem;
        }

        .lb-caption {
            color: #f3f3f3;
            font-size: 1rem;
            text-align: center;
            opacity: .95;
        }

        .lb-top {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: .6rem;
        }

        .lb-close {
            background: transparent;
            border: 0;
            color: #fff;
            font-size: 1.35rem;
            cursor: pointer;
        }

        .lb-close:focus {
            outline: 3px solid rgba(255, 255, 255, 0.12);
        }

        .lb-counter {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.95rem;
        }

        /* Responsive tweaks */
        @media (max-width:768px) {
            .photo-card img {
                aspect-ratio: 16/9;
            }

            .view-btn {
                padding: .4rem .55rem;
                font-size: .95rem;
            }

            .glightbox {
                padding: 1rem;
            }

            .glightbox img {
                border-radius: 10px;
            }
        }

        @media (prefers-reduced-motion: reduce) {

            .photo-card img,
            .glightbox img {
                transition: none;
                animation: none;
            }
        }
    </style>

    <!-- Lightbox -->
    <div id="glightbox" class="glightbox" role="dialog" aria-modal="true" aria-hidden="true"
        aria-label="Visualizador de imagens">
        <div class="inner" role="document">
            <div class="lb-top" style="width:100%">
                <div class="lb-controls" aria-hidden="false">
                    <button class="lb-btn icon" id="lb-prev" aria-label="Imagem anterior">◀</button>
                    <button class="lb-btn icon" id="lb-next" aria-label="Próxima imagem">▶</button>
                </div>
                <div style="display:flex;gap:.6rem;align-items:center;">
                    <div class="lb-counter" id="lb-counter" aria-live="polite">0 / 0</div>
                    <button class="lb-btn" id="lb-download" aria-label="Descarregar imagem">⬇ Descarregar</button>
                    <button class="lb-close" id="lb-close" aria-label="Fechar (Esc)">✕</button>
                </div>
            </div>

            <img id="lb-img" src="" alt="">
            <div id="lb-caption" class="lb-caption" aria-live="polite"></div>
        </div>
    </div>

    <script>
        (function () {
            const gallery = document.querySelectorAll('.photo-card');
            const lightbox = document.getElementById('glightbox');
            const lbImg = document.getElementById('lb-img');
            const lbCaption = document.getElementById('lb-caption');
            const lbClose = document.getElementById('lb-close');
            const lbNext = document.getElementById('lb-next');
            const lbPrev = document.getElementById('lb-prev');
            const lbDownload = document.getElementById('lb-download');
            const lbCounter = document.getElementById('lb-counter');

            let current = 0;
            const total = gallery.length;

            // Prepara galerie: clic, botões e keyboard focus
            gallery.forEach((card, idx) => {
                const img = card.querySelector('img');
                card.dataset.index = idx;
                // botão interno
                const btn = card.querySelector('.view-btn');
                btn.addEventListener('click', () => open(idx));
                // click na imagem (ou Enter/Space)
                img.addEventListener('click', () => open(idx));
                img.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); open(idx); }
                });
                // keyboard focus style handled by CSS :focus-within
            });

            function open(index) {
                current = Number(index);
                const card = gallery[current];
                const img = card.querySelector('img');
                const full = img.dataset.fullsrc || img.currentSrc || img.src;
                lbImg.src = full;
                lbImg.alt = img.alt || '';
                lbCaption.textContent = img.dataset.caption || img.alt || '';
                lbCounter.textContent = (current + 1) + ' / ' + total;
                // download link
                lbDownload.onclick = () => {
                    const a = document.createElement('a');
                    a.href = full;
                    a.download = (new URL(full, location.href).pathname.split('/').pop()) || 'image';
                    document.body.appendChild(a);
                    a.click();
                    a.remove();
                };
                // show
                lightbox.classList.add('open');
                lightbox.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden';
                lbClose.focus();
                // preload next
                preload(current + 1);
            }

            function close() {
                lightbox.classList.remove('open');
                lightbox.setAttribute('aria-hidden', 'true');
                lbImg.src = '';
                document.body.style.overflow = '';
            }

            function next() {
                current = (current + 1) % total;
                open(current);
            }
            function prev() {
                current = (current - 1 + total) % total;
                open(current);
            }

            function preload(idx) {
                if (idx < 0 || idx >= total) return;
                const img = gallery[idx].querySelector('img');
                const src = img.dataset.fullsrc || img.src;
                const i = new Image();
                i.src = src;
            }

            // eventos dos botões
            lbClose.addEventListener('click', close);
            lbNext.addEventListener('click', next);
            lbPrev.addEventListener('click', prev);

            // clique fora fecha
            lightbox.addEventListener('click', (e) => { if (e.target === lightbox) close(); });

            // keyboard
            document.addEventListener('keydown', (e) => {
                if (lightbox.classList.contains('open')) {
                    if (e.key === 'Escape') close();
                    if (e.key === 'ArrowRight') next();
                    if (e.key === 'ArrowLeft') prev();
                }
            });

            // touch swipe (simples)
            let touchStartX = 0;
            let touchEndX = 0;
            lbImg.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; }, { passive: true });
            lbImg.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                if (touchEndX - touchStartX > 40) prev();
                if (touchStartX - touchEndX > 40) next();
            }, { passive: true });

            // prevenção: se imagem falhar, fecha
            lbImg.addEventListener('error', () => {
                lbCaption.textContent = 'Não foi possível carregar a imagem.';
            });

        })();
    </script>


    <!-- ====== SECCAO VÍDEOS APRIMORADA ====== -->
    <section aria-labelledby="videos-title">
        <h2 id="videos-title">Vídeos</h2>

        <div class="videos" role="list">
            <!-- Video 1 -->
            <figure class="video-card" role="listitem">
                <div class="vid-wrap">
                    <video class="media" preload="metadata" controls playsinline poster="poster1.jpg" tabindex="0">
                        <source src="Vingadores.Ultimato.2019.BDRip.x264-DUAL.WWW.COMANDOTORRENTS.COM.mkv"
                            type="video/mp4">
                        <source src="video1.ogg" type="video/ogg">
                        O seu navegador não suporta a tag de vídeo.
                    </video>
                    <button class="play-overlay" aria-label="Reproduzir/Pausar">►</button>
                </div>

                <figcaption class="video-meta">
                    <div class="meta-left">
                        <strong class="video-title">Vingadores — Título (exemplo)</strong>
                        <span class="video-duration" aria-live="polite">—</span>
                    </div>
                    <div class="meta-right">
                        <a class="download-btn" href="#" download aria-label="Descarregar vídeo">⬇ Descarregar</a>
                        <button class="fs-btn" title="Fullscreen" aria-label="Fullscreen">⤢</button>
                    </div>
                </figcaption>
            </figure>

            <!-- Video 2 -->
            <figure class="video-card" role="listitem">
                <div class="vid-wrap">
                    <video class="media" preload="metadata" controls playsinline loop muted poster="poster2.jpg"
                        tabindex="0">
                        <source
                            src="Assistir Boku no Hero Academia the Movie 1- Futari no Hero (Dublado) Online em HD - AnimesROLL.ts"
                            type="video/mp4">
                        <track src="legendas.vtt" kind="subtitles" srclang="pt" label="Português" default>
                        O seu navegador não suporta a tag de vídeo.
                    </video>
                    <button class="play-overlay" aria-label="Reproduzir/Pausar">►</button>
                </div>

                <figcaption class="video-meta">
                    <div class="meta-left">
                        <strong class="video-title">Boku no Hero Academia — Movie (exemplo)</strong>
                        <span class="video-duration" aria-live="polite">—</span>
                    </div>
                    <div class="meta-right">
                        <a class="download-btn" href="#" download aria-label="Descarregar vídeo">⬇ Descarregar</a>
                        <button class="fs-btn" title="Fullscreen" aria-label="Fullscreen">⤢</button>
                    </div>
                </figcaption>
            </figure>
        </div>
    </section>

    <!-- ====== ESTILOS E SCRIPT PARA MELHOR VISIBILIDADE E DOWNLOAD ====== -->
    <style>
        /* vídeo: cartão visual */
        .video-card {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.9), rgba(250, 250, 250, 0.85));
            border-radius: 14px;
            padding: 0.6rem;
            box-shadow: 0 14px 40px rgba(0, 0, 0, 0.08);
            overflow: visible;
        }

        .vid-wrap {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            background: #000;
        }

        .vid-wrap video.media {
            width: 100%;
            height: auto;
            display: block;
            border-radius: 10px;
            background: #000;
            object-fit: contain;
        }

        /* Overlay grande de play para visibilidade */
        .play-overlay {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 84px;
            height: 84px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 180, 0, 0.95), rgba(255, 111, 97, 0.9));
            border: 2px solid rgba(255, 255, 255, 0.15);
            color: #111;
            font-size: 34px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 12px 30px rgba(255, 140, 30, 0.18);
            cursor: pointer;
            opacity: 0.98;
            transition: transform .2s ease, opacity .2s ease;
            z-index: 3;
            backdrop-filter: blur(2px);
        }

        .play-overlay.hidden {
            display: none;
        }

        .play-overlay:hover {
            transform: translate(-50%, -50%) scale(1.06);
        }

        .video-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: .8rem;
            padding: 0 .4rem;
        }

        .video-title {
            color: #222;
            font-size: 1rem;
        }

        .video-duration {
            color: #777;
            font-size: .95rem;
            margin-left: .6rem;
        }

        .meta-right {
            display: flex;
            gap: .6rem;
            align-items: center;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(90deg, #ffb400, #ff6f61);
            color: #111;
            text-decoration: none;
            padding: .45rem .65rem;
            border-radius: 8px;
            font-weight: 700;
            box-shadow: 0 6px 18px rgba(255, 140, 30, 0.12);
        }

        .download-btn:focus {
            outline: 3px solid rgba(255, 180, 0, 0.18);
        }

        .fs-btn {
            background: transparent;
            border: 1px solid rgba(0, 0, 0, 0.06);
            padding: .35rem .5rem;
            border-radius: 8px;
            cursor: pointer;
        }

        /* responsividade e grid inherit */
        .videos {
            gap: 1.2rem;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        }

        @media (max-width:768px) {
            .play-overlay {
                width: 68px;
                height: 68px;
                font-size: 28px;
            }

            .download-btn {
                padding: .4rem .55rem;
                font-size: .95rem;
            }
        }

        /* reduz movimentos para preferências do utilizador */
        @media (prefers-reduced-motion: reduce) {

            .play-overlay,
            .video-card,
            .download-btn {
                transition: none;
            }
        }
    </style>

    <script>
        (function () {
            // Funções utilitárias
            function formatTime(seconds) {
                if (!isFinite(seconds)) return '—';
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                const s = Math.floor(seconds % 60);
                return (h ? (h + ':') : '') + String(m).padStart(h ? 2 : 1, '0') + ':' + String(s).padStart(2, '0');
            }

            // inicializa cada video-card
            document.querySelectorAll('.video-card').forEach(card => {
                const video = card.querySelector('video.media');
                const overlay = card.querySelector('.play-overlay');
                const durationEl = card.querySelector('.video-duration');
                const dlBtn = card.querySelector('.download-btn');
                const fsBtn = card.querySelector('.fs-btn');

                if (!video) return;

                // Quando a metadata carregar, mostra duração e ajusta botão download
                video.addEventListener('loadedmetadata', () => {
                    const dur = isFinite(video.duration) ? formatTime(video.duration) : '—';
                    if (durationEl) durationEl.textContent = dur;
                    // set download link para a fonte actual (currentSrc) - usa a primeira source se necessário
                    const src = video.currentSrc || (video.querySelector('source') && video.querySelector('source').src) || '';
                    if (dlBtn && src) {
                        // extrai nome simples para atributo download
                        try {
                            const url = new URL(src, location.href);
                            const filename = url.pathname.split('/').pop() || 'video';
                            dlBtn.href = url.href;
                            dlBtn.setAttribute('download', filename);
                        } catch (e) {
                            // se src for local path sem URL válido, atribui diretamente
                            dlBtn.href = src;
                            dlBtn.setAttribute('download', '');
                        }
                    }
                });

                // overlay play/pause handling (toggle)
                overlay.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (video.paused) { video.play(); overlay.classList.add('hidden'); }
                    else { video.pause(); overlay.classList.remove('hidden'); }
                });

                // quando o utilizador clicar no video, esconder overlay se a reprodução iniciar
                video.addEventListener('play', () => overlay.classList.add('hidden'));
                video.addEventListener('pause', () => overlay.classList.remove('hidden'));
                video.addEventListener('ended', () => overlay.classList.remove('hidden'));

                // ao clicar no video (navegadores permitem play/pause)
                video.addEventListener('click', () => {
                    if (video.paused) video.play(); else video.pause();
                });

                // botão fullscreen
                fsBtn && fsBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (video.requestFullscreen) video.requestFullscreen();
                    else if (video.webkitRequestFullscreen) video.webkitRequestFullscreen();
                    else if (video.msRequestFullscreen) video.msRequestFullscreen();
                });

                // acessibilidade: ao focar com teclado, mostrar overlay visível (não intrusivo)
                video.addEventListener('focus', () => overlay.classList.remove('hidden'));
            });

            // melhora UX: se o utilizador preferir redução de movimento, remove animações
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelectorAll('.play-overlay').forEach(el => el.style.transition = 'none');
            }
        })();
    </script>


    <!-- ====== SEÇÃO ÁUDIOS APRIMORADA ====== -->
    <section aria-labelledby="audios-title">
        <h2 id="audios-title">Áudios</h2>

        <div class="audios" role="list">
            <!-- Audio 1 -->
            <figure class="audio-card" role="listitem" data-title="Audio 1 — Exemplo">
                <div class="wave" aria-hidden="true"></div>

                <div class="controls">
                    <button class="play" aria-label="Reproduzir Audio 1">►</button>

                    <div class="meta">
                        <div class="title">Áudio 1 — Exemplo</div>
                        <div class="times"><span class="current">0:00</span> / <span class="duration">--:--</span></div>
                    </div>

                    <input class="progress" type="range" min="0" max="100" value="0" aria-label="Progresso do áudio">

                    <div class="right-controls">
                        <button class="loop" aria-pressed="false" title="Loop">🔁</button>
                        <input class="volume" type="range" min="0" max="1" step="0.01" value="1" aria-label="Volume">
                        <a class="download" href="#" download aria-label="Descarregar Áudio">⬇</a>
                    </div>
                </div>

                <!-- elemento áudio nativo (controles nativos ocultos) -->
                <audio preload="metadata" class="native-audio">
                    <source src="audio1.mp3" type="audio/mpeg">
                    <source src="audio1.ogg" type="audio/ogg">
                    O seu navegador não suporta a tag de áudio.
                </audio>
            </figure>

            <!-- Audio 2 -->
            <figure class="audio-card" role="listitem" data-title="Áudio 2 — Exemplo">
                <div class="wave" aria-hidden="true"></div>

                <div class="controls">
                    <button class="play" aria-label="Reproduzir Audio 2">►</button>

                    <div class="meta">
                        <div class="title">Áudio 2 — Exemplo</div>
                        <div class="times"><span class="current">0:00</span> / <span class="duration">--:--</span></div>
                    </div>

                    <input class="progress" type="range" min="0" max="100" value="0" aria-label="Progresso do áudio">

                    <div class="right-controls">
                        <button class="loop" aria-pressed="false" title="Loop">🔁</button>
                        <input class="volume" type="range" min="0" max="1" step="0.01" value="1" aria-label="Volume">
                        <a class="download" href="#" download aria-label="Descarregar Áudio">⬇</a>
                    </div>
                </div>

                <audio preload="metadata" class="native-audio">
                    <source src="audio2.wav" type="audio/wav">
                    O seu navegador não suporta a tag de áudio.
                </audio>
            </figure>

            <!-- Audio 3 (autoplay muted originalmente) -->
            <figure class="audio-card" role="listitem" data-title="Áudio 3 — Exemplo">
                <div class="wave" aria-hidden="true"></div>

                <div class="controls">
                    <button class="play" aria-label="Reproduzir Audio 3">►</button>

                    <div class="meta">
                        <div class="title">Áudio 3 — Exemplo (autoplay muted)</div>
                        <div class="times"><span class="current">0:00</span> / <span class="duration">--:--</span></div>
                    </div>

                    <input class="progress" type="range" min="0" max="100" value="0" aria-label="Progresso do áudio">

                    <div class="right-controls">
                        <button class="loop" aria-pressed="false" title="Loop">🔁</button>
                        <input class="volume" type="range" min="0" max="1" step="0.01" value="0" aria-label="Volume">
                        <a class="download" href="#" download aria-label="Descarregar Áudio">⬇</a>
                    </div>
                </div>

                <audio preload="metadata" class="native-audio" muted autoplay>
                    <source src="audio3.mp3" type="audio/mpeg">
                    O seu navegador não suporta a tag de áudio.
                </audio>
            </figure>
        </div>
    </section>

    <!-- Substitua o bloco CSS+JS dos Áudios por ESTE bloco -->
    <style>
        /* ---------- AUDIOS: UI MODERNA E VISUALIZER ---------- */
        .audios {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.2rem;
            align-items: start;
        }

        /* card */
        .audio-card {
            background: linear-gradient(180deg, #ffffff, #fbfbfb);
            border-radius: 12px;
            padding: 0.8rem;
            box-shadow: 0 14px 36px rgba(12, 12, 12, 0.06);
            overflow: hidden;
            position: relative;
            transition: transform .28s cubic-bezier(.2, .9, .3, 1), box-shadow .28s ease;
        }

        .audio-card:focus-within,
        .audio-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 18px 48px rgba(12, 12, 12, 0.10);
        }

        /* wave visual area (canvas placed inside) */
        .audio-card .wave {
            height: 64px;
            border-radius: 10px;
            margin-bottom: .6rem;
            background: linear-gradient(90deg, rgba(255, 180, 0, 0.06), rgba(255, 111, 97, 0.03));
            box-shadow: inset 0 -6px 18px rgba(255, 180, 0, 0.02);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        /* canvas fills wave container */
        .audio-card .wave canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        /* small play pulse when playing */
        .audio-card.playing .wave::after {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.03), transparent 35%);
            mix-blend-mode: overlay;
            animation: wavePulse 1.8s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes wavePulse {
            0% {
                opacity: .06;
                transform: scale(1);
            }

            50% {
                opacity: .13;
                transform: scale(1.02);
            }

            100% {
                opacity: .06;
                transform: scale(1);
            }
        }

        /* Controls row */
        .controls {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: .6rem;
            align-items: center;
        }

        /* Play button */
        .play {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(180deg, #ffb400, #ff6f61);
            color: #111;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 22px rgba(255, 140, 30, 0.12);
        }

        .play:active {
            transform: translateY(1px);
        }

        .play:focus {
            outline: 3px solid rgba(255, 180, 0, 0.18);
        }

        /* Meta: title + times */
        .meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding-right: .4rem;
            min-width: 0;
        }

        .title {
            font-weight: 700;
            color: #222;
            font-size: 0.98rem;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .times {
            color: #666;
            font-size: 0.9rem;
        }

        /* Progress bar (with buffer background) */
        .progress-wrap {
            position: relative;
            grid-column: 1 / -1;
            width: 100%;
            margin-top: 8px;
        }

        .progress {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 10px;
            border-radius: 10px;
            background: linear-gradient(90deg, #eee, #f6f6f6);
            position: relative;
            z-index: 2;
            cursor: pointer;
        }

        .progress::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: linear-gradient(180deg, #ffb400, #ff6f61);
            box-shadow: 0 4px 12px rgba(255, 140, 30, 0.3);
            border: none;
        }

        .buffer-bar {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 6px;
            border-radius: 8px;
            background: linear-gradient(90deg, rgba(255, 180, 0, 0.14), rgba(255, 111, 97, 0.08));
            width: 0;
            z-index: 1;
            pointer-events: none;
        }

        /* Right controls */
        .right-controls {
            display: flex;
            gap: .5rem;
            align-items: center;
        }

        .loop {
            background: transparent;
            border: 1px solid rgba(0, 0, 0, 0.06);
            padding: .45rem .6rem;
            border-radius: 8px;
            cursor: pointer;
        }

        .loop[aria-pressed="true"] {
            background: linear-gradient(90deg, #ffb400, #ff6f61);
            color: #111;
            border-color: transparent;
        }

        .volume {
            width: 96px;
        }

        .volume::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ffb400;
            border: none;
        }

        .download {
            display: inline-block;
            background: linear-gradient(90deg, #ffb400, #ff6f61);
            color: #111;
            padding: .4rem .55rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 700;
        }

        /* hide native audio (we use custom UI) */
        .native-audio {
            display: none;
        }

        /* accessibility and hover */
        .audio-card:focus-within {
            box-shadow: 0 20px 50px rgba(12, 12, 12, 0.12);
        }

        .audio-card .play:focus,
        .audio-card .loop:focus,
        .audio-card .download:focus {
            outline-offset: 2px;
        }

        /* small screens */
        @media (max-width:600px) {
            .play {
                width: 48px;
                height: 48px;
                font-size: 18px;
            }

            .volume {
                width: 72px;
            }

            .progress {
                height: 8px;
            }

            .wave {
                height: 48px;
            }
        }

        /* reduced motion */
        @media (prefers-reduced-motion: reduce) {

            .audio-card,
            .wave,
            .play {
                transition: none;
                animation: none;
            }

            .audio-card.playing .wave::after {
                display: none;
            }
        }
    </style>

    <script>
        (() => {
            // Simple, efficient audio manager with visualizer
            const cards = [...document.querySelectorAll('.audio-card')];
            if (!cards.length) return;

            // one AudioContext reused (created on first user interaction)
            let audioCtx = null;

            // store per-card state
            const state = new Map();

            function ensureAudioContext() {
                if (audioCtx) return audioCtx;
                try {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) { audioCtx = null; }
                return audioCtx;
            }

            function formatTime(seconds) {
                if (!isFinite(seconds)) return '--:--';
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                const s = Math.floor(seconds % 60);
                return (h ? h + ':' : '') + String(m).padStart(h ? 2 : 1, '0') + ':' + String(s).padStart(2, '0');
            }

            function createAnalyserFor(card) {
                const audio = card.querySelector('.native-audio');
                const wave = card.querySelector('.wave');
                if (!audio) return null;

                const ctx = ensureAudioContext();
                if (!ctx) return null;

                // If already created, return existing
                const st = state.get(card) || {};
                if (st.analyser) return st.analyser;

                // create nodes
                const source = ctx.createMediaElementSource(audio);
                const analyser = ctx.createAnalyser();
                analyser.fftSize = 1024;
                const gain = ctx.createGain();
                source.connect(analyser);
                analyser.connect(gain);
                gain.connect(ctx.destination);

                st.ctx = ctx;
                st.source = source;
                st.analyser = analyser;
                st.gain = gain;
                st.animationId = null;
                st.canvas = null;
                state.set(card, st);

                // create canvas for the visualizer
                let canvas = wave.querySelector('canvas');
                if (!canvas) {
                    canvas = document.createElement('canvas');
                    wave.appendChild(canvas);
                }
                st.canvas = canvas;

                // setup drawing
                const canvasCtx = canvas.getContext('2d');
                function resizeCanvas() {
                    const dpr = window.devicePixelRatio || 1;
                    canvas.width = Math.floor(wave.clientWidth * dpr);
                    canvas.height = Math.floor(wave.clientHeight * dpr);
                    canvas.style.width = `${wave.clientWidth}px`;
                    canvas.style.height = `${wave.clientHeight}px`;
                    canvasCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
                }
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);

                // draw loop
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);

                function draw() {
                    st.animationId = requestAnimationFrame(draw);
                    analyser.getByteFrequencyData(dataArray);
                    canvasCtx.clearRect(0, 0, canvas.width, canvas.height);
                    const width = canvas.width / (window.devicePixelRatio || 1);
                    const height = canvas.height / (window.devicePixelRatio || 1);
                    // gradient
                    const grad = canvasCtx.createLinearGradient(0, 0, width, 0);
                    grad.addColorStop(0, 'rgba(255,180,0,0.95)');
                    grad.addColorStop(0.6, 'rgba(255,111,97,0.95)');
                    grad.addColorStop(1, 'rgba(255,154,0,0.95)');
                    const barWidth = Math.max(2, Math.floor(width / 64));
                    let x = 0;
                    for (let i = 0; i < 64; i++) {
                        const v = dataArray[Math.floor(i * bufferLength / 64)];
                        const barHeight = (v / 255) * height * 0.95;
                        // draw rounded bar
                        canvasCtx.fillStyle = grad;
                        const y = height - barHeight;
                        const bw = barWidth - 1;
                        canvasCtx.beginPath();
                        canvasCtx.moveTo(x, y + 3);
                        canvasCtx.arcTo(x, y, x + bw, y, 2);
                        canvasCtx.lineTo(x + bw, height - 3);
                        canvasCtx.arcTo(x + bw, height, x, height, 2);
                        canvasCtx.closePath();
                        canvasCtx.fill();
                        x += barWidth;
                    }
                }

                // store draw function for start/stop
                st._draw = draw;
                return analyser;
            }

            // Pause others
            function pauseAllExcept(currentAudio) {
                cards.forEach(card => {
                    const audio = card.querySelector('.native-audio');
                    if (!audio) return;
                    if (audio !== currentAudio) {
                        audio.pause();
                        card.classList.remove('playing');
                        const st = state.get(card);
                        if (st && st.animationId) { cancelAnimationFrame(st.animationId); st.animationId = null; }
                    }
                });
            }

            // initialize each card's handlers
            cards.forEach(card => {
                const audio = card.querySelector('.native-audio');
                const playBtn = card.querySelector('.play');
                const progress = card.querySelector('.progress');
                const bufferBar = card.querySelector('.buffer-bar');
                const currentEl = card.querySelector('.current');
                const durationEl = card.querySelector('.duration');
                const loopBtn = card.querySelector('.loop');
                const volume = card.querySelector('.volume');
                const dl = card.querySelector('.download');
                const wave = card.querySelector('.wave');

                if (!audio) return;

                // set initial volume control
                audio.volume = volume ? parseFloat(volume.value || 1) : 1;

                // set download link on metadata loaded
                audio.addEventListener('loadedmetadata', () => {
                    durationEl.textContent = formatTime(audio.duration);
                    // download link
                    const src = audio.currentSrc || (audio.querySelector('source') && audio.querySelector('source').src) || '';
                    if (src && dl) {
                        try {
                            const url = new URL(src, location.href);
                            dl.href = url.href;
                            dl.setAttribute('download', url.pathname.split('/').pop() || 'audio');
                        } catch (e) {
                            dl.href = src; dl.setAttribute('download', '');
                        }
                    }
                });

                // update buffer progress
                audio.addEventListener('progress', () => {
                    try {
                        if (audio.buffered.length) {
                            const end = audio.buffered.end(audio.buffered.length - 1);
                            const pct = Math.min(100, (end / (audio.duration || 1)) * 100);
                            if (bufferBar) bufferBar.style.width = pct + '%';
                        }
                    } catch (e) { }
                });

                // timeupdate -> progress
                audio.addEventListener('timeupdate', () => {
                    if (audio.duration) {
                        const pct = (audio.currentTime / audio.duration) * 100;
                        if (progress) progress.value = pct;
                        if (currentEl) currentEl.textContent = formatTime(audio.currentTime);
                    }
                });

                // play/pause handling
                playBtn.addEventListener('click', async (ev) => {
                    ev.stopPropagation();
                    // resume/create AudioContext on first user gesture to enable visualizer
                    ensureAudioContext();
                    if (audio.paused) {
                        pauseAllExcept(audio);
                        try { await audio.play(); } catch (e) { /* autoplay blocked */ }
                        playBtn.textContent = '❚❚';
                        card.classList.add('playing');

                        // create analyser & start visualizer
                        const analyser = createAnalyserFor(card);
                        const st = state.get(card);
                        if (analyser && st && st._draw && !st.animationId) {
                            st._draw();
                        }
                    } else {
                        audio.pause();
                        playBtn.textContent = '►';
                        card.classList.remove('playing');
                        const st = state.get(card);
                        if (st && st.animationId) { cancelAnimationFrame(st.animationId); st.animationId = null; }
                    }
                });

                // click wave toggles play
                wave.addEventListener('click', () => playBtn.click());

                // scrub with progress bar
                progress.addEventListener('input', () => {
                    if (audio.duration) {
                        const t = (progress.value / 100) * audio.duration;
                        audio.currentTime = t;
                    }
                });

                // loop toggle
                loopBtn.addEventListener('click', () => {
                    audio.loop = !audio.loop;
                    loopBtn.setAttribute('aria-pressed', String(audio.loop));
                    loopBtn.style.background = audio.loop ? 'linear-gradient(90deg,#ffb400,#ff6f61)' : 'transparent';
                });

                // volume
                volume.addEventListener('input', () => { audio.volume = parseFloat(volume.value); });

                // ended
                audio.addEventListener('ended', () => {
                    playBtn.textContent = '►';
                    card.classList.remove('playing');
                    const st = state.get(card);
                    if (st && st.animationId) { cancelAnimationFrame(st.animationId); st.animationId = null; }
                    // autoplay next if attribute set
                    const autoplayNext = card.closest('.audios') && card.closest('.audios').dataset.autoplayNext === 'true';
                    if (autoplayNext) {
                        const idx = cards.indexOf(card);
                        const nextIdx = (idx + 1) % cards.length;
                        const nextCard = cards[nextIdx];
                        if (nextCard) {
                            const nextAudio = nextCard.querySelector('.native-audio');
                            if (nextAudio) {
                                pauseAllExcept(nextAudio);
                                nextAudio.play().catch(() => { });
                                nextCard.querySelector('.play').textContent = '❚❚';
                                nextCard.classList.add('playing');
                                createAnalyserFor(nextCard);
                            }
                        }
                    }
                });

                // keyboard accessibility: space / enter toggles play
                [playBtn, card].forEach(el => {
                    el.addEventListener('keydown', (e) => {
                        if (e.key === ' ' || e.key === 'Enter') { e.preventDefault(); playBtn.click(); }
                    });
                });

                // handle focus: start AudioContext on focus click for some browsers
                card.addEventListener('pointerdown', () => ensureAudioContext(), { passive: true });
            });

            // stop all visualizers when unloading
            window.addEventListener('pagehide', () => {
                state.forEach((st, card) => {
                    if (st && st.animationId) cancelAnimationFrame(st.animationId);
                    if (st && st.source) {
                        try { st.source.disconnect(); } catch (e) { }
                    }
                });
            });

        })();
    </script>


    <footer>
        <p>Galeria Multimédia — <span>HTML5</span>, <span>CSS3</span> & animações suaves | © 2025 Gabrio Manuel Bento
        </p>
    </footer>

</body>

</html>